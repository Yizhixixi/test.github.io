---
layout: post
category: java
title: Lambda è¡¨è¾¾å¼å…¥é—¨ï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†
tagline: by æ²‰é»˜ç‹äºŒ
tag: java
---

è¯´å‡ºæ¥æ€•ä½ ä»¬ä¸ç›¸ä¿¡ï¼Œåˆšæ¥åˆ°ç‰©ä¸šé€šçŸ¥ï¼Œç–«æƒ…é˜²æ§å‡çº§äº†ï¼Œè½¦è¾†åªèƒ½å‡ºä¸èƒ½è¿›ï¼Œæ¯æˆ·å®¶åº­æ¯å¤©å¯æŒ‡æ´¾ 1 åæˆå‘˜ä¸Šè¡—é‡‡è´­ç”Ÿæ´»ç”¨å“ã€‚è¿™ä¸æ˜¯è°£è¨€ï¼Œæˆªä¸ªå›¾è‡ªè¯æ¸…ç™½ï¼Œå‡ºè‡ªæ´›é˜³å¸‚æ¹–åŒ—è·¯è¡—é“å¤„ã€‚


<!--more-->





![](http://www.itwanger.com/assets/images/2020/02/Lambda-01.png)

çœ‹æ¥äº‹æ€ä¸¥å³»ï¼Œè¿™æ ·çœ‹ä¼¼å¥½å¿ƒï¼Œä½†ä¸ä¸€å®šåŠå¥½äº‹ï¼Œå»è¶…æ—¶æŠ¢è´­çš„äººä¼šæ›´å¤šã€‚ä¸ç®¡äº†ï¼Œåªèƒ½çªåœ¨å®¶åšæŒä¹…æˆ˜äº†ã€‚è¶è¿™æ®µæ—¶é—´ï¼Œå¤šåˆ†äº«ä¸€äº›åŸåˆ›æ–‡ç« ç»™ä½ ä»¬â€”â€”æœ‰çœ¼ç¦äº†å‘€ï¼Œå¤šå‚¨å¤‡ç‚¹çŸ¥è¯†ï¼Œç–«æƒ…ç»“æŸåè‚¯å®šèƒ½æ´¾ä¸Šå¤§ç”¨åœºã€‚ä»Šå¤©åˆ†äº«çš„ä¸»é¢˜æ˜¯ã€ŠLambda è¡¨è¾¾å¼ã€‹ï¼Œè¿™ä¹Ÿæ˜¯ä¹‹å‰ä¸€äº›è¯»è€…ç•™è¨€å¼ºçƒˆè¦æ±‚æˆ‘å†™ä¸€å†™çš„ï¼Œä¸å¥½æ„æ€ï¼Œè®©ä½ ä»¬ä¹…ç­‰äº†ï¼Œç°åœ¨æ¥æ»¡è¶³ä½ ä»¬ï¼Œä¸ºæ—¶ä¸æ™šå§ï¼Ÿ

![](http://www.itwanger.com/assets/images/2020/02/Lambda-02.png)

### 01ã€åˆè¯† Lambda

Lambda è¡¨è¾¾å¼æè¿°äº†ä¸€ä¸ªä»£ç å—ï¼ˆæˆ–è€…å«åŒ¿åæ–¹æ³•ï¼‰ï¼Œå¯ä»¥å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™æ„é€ æ–¹æ³•æˆ–è€…æ™®é€šæ–¹æ³•ä»¥ä¾¿åç»­æ‰§è¡Œã€‚è€ƒè™‘ä¸‹é¢è¿™æ®µä»£ç ï¼š

```java
() -> System.out.println("æ²‰é»˜ç‹äºŒ")
```

æ¥ä»å·¦åˆ°å³è§£é‡Šä¸€ä¸‹ï¼Œ`()` ä¸º Lambda è¡¨è¾¾å¼çš„å‚æ•°åˆ—è¡¨ï¼ˆæœ¬ä¾‹ä¸­æ²¡æœ‰å‚æ•°ï¼‰ï¼Œ`->` æ ‡è¯†è¿™ä¸²ä»£ç ä¸º Lambda è¡¨è¾¾å¼ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œçœ‹åˆ° `->` å°±çŸ¥é“è¿™æ˜¯ Lambdaï¼‰ï¼Œ`System.out.println("æ²‰é»˜ç‹äºŒ")` ä¸ºè¦æ‰§è¡Œçš„ä»£ç ï¼Œå³å°†â€œæ²‰é»˜ç‹äºŒâ€æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºæµã€‚

æœ‰ç‚¹ Java åŸºç¡€çš„åŒå­¦åº”è¯¥ä¸ä¼šå¯¹ Runnable æ¥å£æ„Ÿåˆ°é™Œç”Ÿï¼Œè¿™æ˜¯å¤šçº¿ç¨‹çš„ä¸€ä¸ªåŸºç¡€æ¥å£ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š

```java
@FunctionalInterface
public interface Runnable
{
   public abstract void run();
}
```

Runnable æ¥å£éå¸¸ç®€å•ï¼Œä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³• `run()`ï¼›ç»†å¿ƒçš„åŒå­¦ä¼šå‘ç°ä¸€ä¸ªé™Œç”Ÿçš„æ³¨è§£ `@FunctionalInterface`ï¼Œè¿™ä¸ªæ³¨è§£æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ

æˆ‘çœ‹äº†å®ƒçš„æºç ï¼Œé‡Œé¢æœ‰è¿™æ ·ä¸€æ®µæ³¨é‡Šï¼š

>Note that instances of functional interfaces can be created with lambda expressions, method references, or constructor references.

å¤§è‡´çš„æ„æ€å°±æ˜¯è¯´ï¼Œé€šè¿‡ `@FunctionalInterface` æ ‡è®°çš„æ¥å£å¯ä»¥é€šè¿‡ Lambda è¡¨è¾¾å¼åˆ›å»ºå®ä¾‹ã€‚å…·ä½“æ€ä¹ˆè¡¨ç°å‘¢ï¼Ÿ

åŸæ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¹¶å¯åŠ¨å®ƒæ˜¯è¿™æ ·çš„ï¼š

```java
public class LamadaTest {
    public static void main(String[] args) {
        new Thread(new Runnable() {
            @Override
            public void run() {
                System.out.println("æ²‰é»˜ç‹äºŒ");
            }
        }).start();
    }
}
```

é€šè¿‡ Lambda è¡¨è¾¾å¼å‘¢ï¼Ÿåªéœ€è¦ä¸‹é¢è¿™æ ·ï¼š

```java
public class LamadaTest {
    public static void main(String[] args) {
        new Thread(() -> System.out.println("æ²‰é»˜ç‹äºŒ")).start();
    }
}
```

æ˜¯ä¸æ˜¯å¾ˆå¦™ï¼æ¯”èµ·åŒ¿åå†…éƒ¨ç±»ï¼ŒLambda è¡¨è¾¾å¼ä¸ä»…æ˜“äºç†è§£ï¼Œæ›´å¤§å¤§ç®€åŒ–äº†å¿…é¡»ç¼–å†™çš„ä»£ç æ•°é‡ã€‚

![](http://www.itwanger.com/assets/images/2020/02/Lambda-03.png)

### 02ã€Lambda è¯­æ³•

æ¯ä¸ª Lambda è¡¨è¾¾å¼éƒ½éµå¾ªä»¥ä¸‹æ³•åˆ™ï¼š

```
( parameter-list ) -> { expression-or-statements }
```

`()` ä¸­çš„ `parameter-list` æ˜¯ä»¥é€—å·åˆ†éš”çš„å‚æ•°ã€‚ä½ å¯ä»¥æŒ‡å®šå‚æ•°çš„ç±»å‹ï¼Œä¹Ÿå¯ä»¥ä¸æŒ‡å®šï¼ˆç¼–è¯‘å™¨ä¼šæ ¹æ®ä¸Šä¸‹æ–‡è¿›è¡Œæ¨æ–­ï¼‰ã€‚Java 11 åï¼Œè¿˜å¯ä»¥ä½¿ç”¨ `var` å…³é”®å­—ä½œä¸ºå‚æ•°ç±»å‹ï¼Œæœ‰ç‚¹ JavaScript çš„å‘³é“ã€‚

`->` ç›¸å½“äº Lambda çš„æ ‡è¯†ç¬¦ï¼Œå°±å¥½åƒè§åˆ°åœ£æ—¨å°±è§åˆ°äº†çš‡ä¸Šã€‚

`{}` ä¸­çš„ `expression-or-statements` ä¸º Lambda çš„ä¸»ä½“ï¼Œå¯ä»¥æ˜¯ä¸€è¡Œè¯­å¥ï¼Œä¹Ÿå¯ä»¥å¤šè¡Œã€‚

å¯ä»¥é€šè¿‡ Lambda è¡¨è¾¾å¼å¹²å¾ˆå¤šäº‹æƒ…ï¼Œæ¯”å¦‚è¯´

1ï¼‰ä¸ºå˜é‡èµ‹å€¼ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```java
Runnable r = () -> { System.out.println("æ²‰é»˜ç‹äºŒ"); };
r.run();
```

2ï¼‰ä½œä¸º return ç»“æœï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```java
static FileFilter getFilter(String ext)
{
    return (pathname) -> pathname.toString().endsWith(ext);
}
```

3ï¼‰ä½œä¸ºæ•°ç»„å…ƒç´ ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```java
final PathMatcher matchers[] =
{
        (path) -> path.toString().endsWith("txt"),
        (path) -> path.toString().endsWith("java")
};
```

4ï¼‰ä½œä¸ºæ™®é€šæ–¹æ³•æˆ–è€…æ„é€ æ–¹æ³•çš„å‚æ•°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```java
new Thread(() -> System.out.println("æ²‰é»˜ç‹äºŒ")).start();
```

éœ€è¦æ³¨æ„ Lambda è¡¨è¾¾å¼çš„ä½œç”¨åŸŸèŒƒå›´ã€‚

```java
public static void main(String[] args) {

    int limit = 10;
    Runnable r = () -> {
        int limit = 5;
        for (int i = 0; i < limit; i++)
            System.out.println(i);
    };
}
```

ä¸Šé¢è¿™æ®µä»£ç åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šæç¤ºé”™è¯¯ï¼šå˜é‡ limit å·²ç»å®šä¹‰è¿‡äº†ã€‚

å’ŒåŒ¿åå†…éƒ¨ç±»ä¸€æ ·ï¼Œä¸è¦åœ¨ Lambda è¡¨è¾¾å¼ä¸»ä½“å†…å¯¹æ–¹æ³•å†…çš„å±€éƒ¨å˜é‡è¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™ç¼–è¯‘ä¹Ÿä¸ä¼šé€šè¿‡ï¼šLambda è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„å˜é‡å¿…é¡»æ˜¯ final çš„ã€‚

![](http://www.itwanger.com/assets/images/2020/02/Lambda-04.png)


### 03ã€Lambda å’Œ this å…³é”®å­—

Lambda è¡¨è¾¾å¼å¹¶ä¸ä¼šå¼•å…¥æ–°çš„ä½œç”¨åŸŸï¼Œè¿™ä¸€ç‚¹å’ŒåŒ¿åå†…éƒ¨ç±»æ˜¯ä¸åŒçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒLambda è¡¨è¾¾å¼ä¸»ä½“å†…ä½¿ç”¨çš„ this å…³é”®å­—å’Œå…¶æ‰€åœ¨çš„ç±»å®ä¾‹ç›¸åŒã€‚

æ¥çœ‹ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ã€‚

```java
public class LamadaTest {
    public static void main(String[] args) {
        new LamadaTest().work();
    }

    public void work() {
        System.out.printf("this = %s%n", this);

        Runnable r = new Runnable()
        {
            @Override
            public void run()
            {
                System.out.printf("this = %s%n", this);
            }
        };
        new Thread(r).start();
        new Thread(() -> System.out.printf("this = %s%n", this)).start();
    }
}
```

Tipsï¼š`%s` ä»£è¡¨å½“å‰ä½ç½®è¾“å‡ºå­—ç¬¦ä¸²ï¼Œ`%n` ä»£è¡¨æ¢è¡Œç¬¦ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `\n` ä»£æ›¿ï¼Œä½† `%n` æ˜¯è·¨å¹³å°çš„ã€‚

`work()` æ–¹æ³•ä¸­çš„ä»£ç å¯ä»¥åˆ†ä¸º 3 ä¸ªéƒ¨åˆ†ï¼š

1ï¼‰å•ç‹¬çš„ this å…³é”®å­—

```java
System.out.printf("this = %s%n", this);
```

å…¶ä¸­ this ä¸º `main()` æ–¹æ³•ä¸­é€šè¿‡ new å…³é”®å­—åˆ›å»ºçš„ LamadaTest å¯¹è±¡â€”â€”`new LamadaTest()`ã€‚

2ï¼‰åŒ¿åå†…éƒ¨ç±»ä¸­çš„ this å…³é”®å­—

```java
Runnable r = new Runnable()
{
    @Override
    public void run()
    {
        System.out.printf("this = %s%n", this);
    }
};
```

å…¶ä¸­ this ä¸º `work()` æ–¹æ³•ä¸­é€šè¿‡ new å…³é”®å­—åˆ›å»ºçš„ Runnable å¯¹è±¡â€”â€”`new Runnable(){...}`ã€‚

3ï¼‰Lambda è¡¨è¾¾å¼ä¸­çš„ this å…³é”®å­—

å…¶ä¸­ this å…³é”®å­—å’Œ 1ï¼‰ä¸­çš„ç›¸åŒã€‚

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ç¨‹åºçš„è¾“å‡ºç»“æœï¼š

```java
this = com.cmower.java_demo.journal.LamadaTest@3feba861
this = com.cmower.java_demo.journal.LamadaTest$1@64f033cb
this = com.cmower.java_demo.journal.LamadaTest@3feba861
```

ç¬¦åˆæˆ‘ä»¬åˆ†æçš„é¢„æœŸã€‚

![](http://www.itwanger.com/assets/images/2020/02/Lambda-05.png)

### 04ã€æœ€å

å°½ç®¡ Lambda è¡¨è¾¾å¼åœ¨ç®€åŒ– Java ç¼–ç¨‹æ–¹é¢åšäº†å¾ˆå¤šä»¤äººæƒŠè®¶çš„åŠªåŠ›ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸å½“çš„ä½¿ç”¨ä»ç„¶ä¼šå¯¼è‡´ä¸å¿…è¦çš„æ··ä¹±ï¼Œå¤§å®¶ä¼™æ…ç”¨ã€‚

å¥½äº†ï¼Œæˆ‘äº²çˆ±çš„è¯»è€…æœ‹å‹ä»¬ï¼Œä»¥ä¸Šå°±æ˜¯æœ¬æ–‡çš„å…¨éƒ¨å†…å®¹äº†ã€‚èƒ½åœ¨ç–«æƒ…æœŸé—´åšæŒçœ‹æŠ€æœ¯æ–‡ï¼ŒäºŒå“¥å¿…é¡»è¦ä¼¸å‡ºå¤§æ‹‡æŒ‡ä¸ºä½ ç‚¹ä¸ªèµğŸ‘ï¼Œç–«æƒ…è¿‡åï¼Œæˆ‘ç›¸ä¿¡ä½ çš„æ‰åä¸€å®šä¼šå±•éœ²æ— ç–‘ã€‚

åŸåˆ›ä¸æ˜“ï¼Œå¦‚æœè§‰å¾—æœ‰ç‚¹ç”¨çš„è¯ï¼Œè¯·ä¸è¦åå•¬ä½ æ‰‹ä¸­**ç‚¹èµ**çš„æƒåŠ›â€”â€”å› ä¸ºè¿™å°†æ˜¯æˆ‘å†™ä½œçš„æœ€å¼ºåŠ¨åŠ›ã€‚


![](http://www.itwanger.com/assets/images/cmower_3.png)